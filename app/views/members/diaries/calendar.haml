!!!
%html{:lang => "en"}
  %head
    %meta{:charset => "utf-8"}/
    %title Full Calendar - Ace Admin
    %meta{:content => "with draggable and editable events", :name => "description"}/
    %meta{:content => "width=device-width, initial-scale=1.0", :name => "viewport"}/
    / basic styles
    %link{:href => "assets/css/bootstrap.min.css", :rel => "stylesheet"}/
    %link{:href => "assets/css/bootstrap-responsive.min.css", :rel => "stylesheet"}/
    %link{:href => "assets/css/font-awesome.min.css", :rel => "stylesheet"}/
    /[if IE 7]
      <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
    / page specific plugin styles
    %link{:href => "assets/css/fullcalendar.css", :rel => "stylesheet"}/
    / fonts
    %link{:href => "assets/css/ace-fonts.css", :rel => "stylesheet"}/
    / ace styles
    %link{:href => "assets/css/ace.min.css", :rel => "stylesheet"}/
    %link{:href => "assets/css/ace-responsive.min.css", :rel => "stylesheet"}/
    %link{:href => "assets/css/ace-skins.min.css", :rel => "stylesheet"}/
    /[if lte IE 8]
      <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
    / inline styles related to this page
  %body
    .navbar
      .navbar-inner
        .container-fluid
          %a.brand{:href => "#"}
            %small
              %i.icon-leaf
              Ace Admin
          / /.brand
          %ul.nav.ace-nav.pull-right
            %li.grey
              %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                %i.icon-tasks
                %span.badge.badge-grey 4
              %ul.pull-right.dropdown-navbar.dropdown-menu.dropdown-caret.dropdown-closer
                %li.nav-header
                  %i.icon-ok
                  4 Tasks to complete
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left Software Update
                    %span.pull-right 65%
                  .progress.progress-mini
                    .bar{:style => "width:65%"}
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left Hardware Upgrade
                    %span.pull-right 35%
                  .progress.progress-mini.progress-danger
                    .bar{:style => "width:35%"}
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left Unit Testing
                    %span.pull-right 15%
                  .progress.progress-mini.progress-warning
                    .bar{:style => "width:15%"}
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left Bug Fixes
                    %span.pull-right 90%
                  .progress.progress-mini.progress-success.progress-striped.active
                    .bar{:style => "width:90%"}
                %li
                  %a{:href => "#"}
                    See tasks with details
                    %i.icon-arrow-right
            %li.purple
              %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                %i.icon-bell-alt.icon-animated-bell
                %span.badge.badge-important 8
              %ul.pull-right.dropdown-navbar.navbar-pink.dropdown-menu.dropdown-caret.dropdown-closer
                %li.nav-header
                  %i.icon-warning-sign
                  8 Notifications
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left
                      %i.btn.btn-mini.no-hover.btn-pink.icon-comment
                      New Comments
                    %span.pull-right.badge.badge-info +12
                %li
                  %a{:href => "#"}
                    %i.btn.btn-mini.btn-primary.icon-user
                    Bob just signed up as an editor ...
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left
                      %i.btn.btn-mini.no-hover.btn-success.icon-shopping-cart
                      New Orders
                    %span.pull-right.badge.badge-success +8
                %li
                  %a{:href => "#"}
                  .clearfix
                    %span.pull-left
                      %i.btn.btn-mini.no-hover.btn-info.icon-twitter
                      Followers
                    %span.pull-right.badge.badge-info +11
                %li
                  %a{:href => "#"}
                    See all notifications
                    %i.icon-arrow-right
            %li.green
              %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                %i.icon-envelope.icon-animated-vertical
                %span.badge.badge-success 5
              %ul.pull-right.dropdown-navbar.dropdown-menu.dropdown-caret.dropdown-closer
                %li.nav-header
                  %i.icon-envelope-alt
                  5 Messages
                %li
                  %a{:href => "#"}
                    %img.msg-photo{:alt => "Alex's Avatar", :src => "assets/avatars/avatar.png"}/
                    %span.msg-body
                      %span.msg-title
                        %span.blue Alex:
                        Ciao sociis natoque penatibus et auctor ...
                      %span.msg-time
                        %i.icon-time
                        %span a moment ago
                %li
                  %a{:href => "#"}
                    %img.msg-photo{:alt => "Susan's Avatar", :src => "assets/avatars/avatar3.png"}/
                    %span.msg-body
                      %span.msg-title
                        %span.blue Susan:
                        Vestibulum id ligula porta felis euismod ...
                      %span.msg-time
                        %i.icon-time
                        %span 20 minutes ago
                %li
                  %a{:href => "#"}
                    %img.msg-photo{:alt => "Bob's Avatar", :src => "assets/avatars/avatar4.png"}/
                    %span.msg-body
                      %span.msg-title
                        %span.blue Bob:
                        Nullam quis risus eget urna mollis ornare ...
                      %span.msg-time
                        %i.icon-time
                        %span 3:15 pm
                %li
                  %a{:href => "#"}
                    See all messages
                    %i.icon-arrow-right
            %li.light-blue
              %a.dropdown-toggle{"data-toggle" => "dropdown", :href => "#"}
                %img.nav-user-photo{:alt => "Jason's Photo", :src => "assets/avatars/user.jpg"}/
                %span.user-info
                  %small Welcome,
                  Jason
                %i.icon-caret-down
              %ul.user-menu.pull-right.dropdown-menu.dropdown-yellow.dropdown-caret.dropdown-closer
                %li
                  %a{:href => "#"}
                    %i.icon-cog
                    Settings
                %li
                  %a{:href => "#"}
                    %i.icon-user
                    Profile
                %li.divider
                %li
                  %a{:href => "#"}
                    %i.icon-off
                    Logout
          / /.ace-nav
        / /.container-fluid
      / /.navbar-inner
    .main-container.container-fluid
      %a#menu-toggler.menu-toggler{:href => "#"}
        %span.menu-text
      #sidebar.sidebar
        #sidebar-shortcuts.sidebar-shortcuts
          #sidebar-shortcuts-large.sidebar-shortcuts-large
            %button.btn.btn-small.btn-success
              %i.icon-signal
            %button.btn.btn-small.btn-info
              %i.icon-pencil
            %button.btn.btn-small.btn-warning
              %i.icon-group
            %button.btn.btn-small.btn-danger
              %i.icon-cogs
          #sidebar-shortcuts-mini.sidebar-shortcuts-mini
            %span.btn.btn-success
            %span.btn.btn-info
            %span.btn.btn-warning
            %span.btn.btn-danger
        / #sidebar-shortcuts
        %ul.nav.nav-list
          %li
            %a{:href => "index.html"}
              %i.icon-dashboard
              %span.menu-text Dashboard
          %li
            %a{:href => "typography.html"}
              %i.icon-text-width
              %span.menu-text Typography
          %li
            %a.dropdown-toggle{:href => "#"}
              %i.icon-desktop
              %span.menu-text UI Elements
              %b.arrow.icon-angle-down
            %ul.submenu
              %li
                %a{:href => "elements.html"}
                  %i.icon-double-angle-right
                  Elements
              %li
                %a{:href => "buttons.html"}
                  %i.icon-double-angle-right
                  Buttons &amp; Icons
              %li
                %a{:href => "treeview.html"}
                  %i.icon-double-angle-right
                  Treeview
              %li
                %a.dropdown-toggle{:href => "#"}
                  %i.icon-double-angle-right
                  Three Level Menu
                  %b.arrow.icon-angle-down
                %ul.submenu
                  %li
                    %a{:href => "#"}
                      %i.icon-leaf
                      Item #1
                  %li
                    %a.dropdown-toggle{:href => "#"}
                      %i.icon-pencil
                      4th level
                      %b.arrow.icon-angle-down
                    %ul.submenu
                      %li
                        %a{:href => "#"}
                          %i.icon-plus
                          Add Product
                      %li
                        %a{:href => "#"}
                          %i.icon-eye-open
                          View Products
          %li
            %a{:href => "tables.html"}
              %i.icon-list
              %span.menu-text Tables
          %li
            %a.dropdown-toggle{:href => "#"}
              %i.icon-edit
              %span.menu-text Forms
              %b.arrow.icon-angle-down
            %ul.submenu
              %li
                %a{:href => "form-elements.html"}
                  %i.icon-double-angle-right
                  Form Elements
              %li
                %a{:href => "form-wizard.html"}
                  %i.icon-double-angle-right
                  Wizard &amp; Validation
              %li
                %a{:href => "wysiwyg.html"}
                  %i.icon-double-angle-right
                  Wysiwyg &amp; Markdown
          %li
            %a{:href => "widgets.html"}
              %i.icon-list-alt
              %span.menu-text Widgets
          %li.active
            %a{:href => "calendar.html"}
              %i.icon-calendar
              %span.menu-text
                Calendar
                %span.badge.badge-transparent.tooltip-error{:title => "2&nbsp;Important&nbsp;Events"}
                  %i.icon-warning-sign.red.bigger-130
          %li
            %a{:href => "gallery.html"}
              %i.icon-picture
              %span.menu-text Gallery
          %li
            %a.dropdown-toggle{:href => "#"}
              %i.icon-tag
              %span.menu-text More Pages
              %b.arrow.icon-angle-down
            %ul.submenu
              %li
                %a{:href => "profile.html"}
                  %i.icon-double-angle-right
                  User Profile
              %li
                %a{:href => "pricing.html"}
                  %i.icon-double-angle-right
                  Pricing Tables
              %li
                %a{:href => "invoice.html"}
                  %i.icon-double-angle-right
                  Invoice
              %li
                %a{:href => "login.html"}
                  %i.icon-double-angle-right
                  Login &amp; Register
          %li
            %a.dropdown-toggle{:href => "#"}
              %i.icon-file-alt
              %span.menu-text
                Other Pages
                %span.badge.badge-primary 4
              %b.arrow.icon-angle-down
            %ul.submenu
              %li
                %a{:href => "error-404.html"}
                  %i.icon-double-angle-right
                  Error 404
              %li
                %a{:href => "error-500.html"}
                  %i.icon-double-angle-right
                  Error 500
              %li
                %a{:href => "grid.html"}
                  %i.icon-double-angle-right
                  Grid
              %li
                %a{:href => "blank.html"}
                  %i.icon-double-angle-right
                  Blank Page
        / /.nav-list
        #sidebar-collapse.sidebar-collapse
          %i.icon-double-angle-left
      .main-content
        #breadcrumbs.breadcrumbs
          %ul.breadcrumb
            %li
              %i.icon-home.home-icon
              %a{:href => "#"} Home
              %span.divider
                %i.icon-angle-right.arrow-icon
            %li.active Calendar
          / .breadcrumb
          #nav-search.nav-search
            %form.form-search
              %span.input-icon
                %input#nav-search-input.input-small.nav-search-input{:autocomplete => "off", :placeholder => "Search ...", :type => "text"}/
                %i.icon-search.nav-search-icon
          / #nav-search
        .page-content
          .page-header.position-relative
            %h1
              Full Calendar
              %small
                %i.icon-double-angle-right
                with draggable and editable events
          / /.page-header
          .row-fluid
            .span12
              / PAGE CONTENT BEGINS
              .row-fluid
                .span9
                  .space
                  #calendar
                .span3
                  .widget-box.transparent
                    .widget-header
                      %h4 Draggable events
                    .widget-main
                      #external-events
                        .external-event.label-grey{"data-class" => "label-grey"}
                          %i.icon-move
                          My Event 1
                        .external-event.label-success{"data-class" => "label-success"}
                          %i.icon-move
                          My Event 2
                        .external-event.label-important{"data-class" => "label-important"}
                          %i.icon-move
                          My Event 3
                        .external-event.label-purple{"data-class" => "label-purple"}
                          %i.icon-move
                          My Event 4
                        .external-event.label-yellow{"data-class" => "label-yellow"}
                          %i.icon-move
                          My Event 5
                        .external-event.label-pink{"data-class" => "label-pink"}
                          %i.icon-move
                          My Event 6
                        .external-event.label-info{"data-class" => "label-info"}
                          %i.icon-move
                          My Event 7
                        %label
                          %input#drop-remove.ace-checkbox{:type => "checkbox"}/
                          %span.lbl Remove after drop
              / PAGE CONTENT ENDS
            / /.span
          / /.row-fluid
        / /.page-content
        #ace-settings-container.ace-settings-container
          #ace-settings-btn.btn.btn-app.btn-mini.btn-warning.ace-settings-btn
            %i.icon-cog.bigger-150
          #ace-settings-box.ace-settings-box
            %div
              .pull-left
                %select#skin-colorpicker.hide
                  %option{"data-class" => "default", :value => "#438EB9"} #438EB9
                  %option{"data-class" => "skin-1", :value => "#222A2D"} #222A2D
                  %option{"data-class" => "skin-2", :value => "#C6487E"} #C6487E
                  %option{"data-class" => "skin-3", :value => "#D0D0D0"} #D0D0D0
              %span &nbsp; Choose Skin
            %div
              %input#ace-settings-header.ace-checkbox-2{:type => "checkbox"}/
              %label.lbl{:for => "ace-settings-header"} Fixed Header
            %div
              %input#ace-settings-sidebar.ace-checkbox-2{:type => "checkbox"}/
              %label.lbl{:for => "ace-settings-sidebar"} Fixed Sidebar
            %div
              %input#ace-settings-breadcrumbs.ace-checkbox-2{:type => "checkbox"}/
              %label.lbl{:for => "ace-settings-breadcrumbs"} Fixed Breadcrumbs
            %div
              %input#ace-settings-rtl.ace-checkbox-2{:type => "checkbox"}/
              %label.lbl{:for => "ace-settings-rtl"} Right To Left (rtl)
        / /#ace-settings-container
      / /.main-content
    / /.main-container
    %a#btn-scroll-up.btn-scroll-up.btn.btn-small.btn-inverse{:href => "#"}
      %i.icon-double-angle-up.icon-only.bigger-110
    / basic scripts
    / [if !IE]>
    :javascript
      window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>"+"<"+"/script>");
    / <![endif]
    /[if IE]
      <script type="text/javascript">
      window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
      </script>
    :javascript
      if("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
    %script{:src => "assets/js/bootstrap.min.js"}
    / page specific plugin scripts
    %script{:src => "assets/js/jquery-ui-1.10.3.custom.min.js"}
    %script{:src => "assets/js/jquery.ui.touch-punch.min.js"}
    %script{:src => "assets/js/fullcalendar.min.js"}
    %script{:src => "assets/js/bootbox.min.js"}
    / ace scripts
    %script{:src => "assets/js/ace-elements.min.js"}
    %script{:src => "assets/js/ace.min.js"}
    / inline scripts related to this page
    :javascript
      $(function() {
      
      /* initialize the external events
      	-----------------------------------------------------------------*/
      
      	$('#external-events div.external-event').each(function() {
      
      		// create an Event Object (http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)
      		// it doesn't need to have a start or end
      		var eventObject = {
      			title: $.trim($(this).text()) // use the element's text as the event title
      		};
      
      		// store the Event Object in the DOM element so we can get to it later
      		$(this).data('eventObject', eventObject);
      
      		// make the event draggable using jQuery UI
      		$(this).draggable({
      			zIndex: 999,
      			revert: true,      // will cause the event to go back to its
      			revertDuration: 0  //  original position after the drag
      		});
      		
      	});
      
      
      
      
      	/* initialize the calendar
      	-----------------------------------------------------------------*/
      
      	var date = new Date();
      	var d = date.getDate();
      	var m = date.getMonth();
      	var y = date.getFullYear();
      
      	
      	var calendar = $('#calendar').fullCalendar({
      		 buttonText: {
      			prev: '<i class="icon-chevron-left"></i>',
      			next: '<i class="icon-chevron-right"></i>'
      		},
      	
      		header: {
      			left: 'prev,next today',
      			center: 'title',
      			right: 'month,agendaWeek,agendaDay'
      		},
      		events: [
      		{
      			title: 'All Day Event',
      			start: new Date(y, m, 1),
      			className: 'label-important'
      		},
      		{
      			title: 'Long Event',
      			start: new Date(y, m, d-5),
      			end: new Date(y, m, d-2),
      			className: 'label-success'
      		},
      		{
      			title: 'Some Event',
      			start: new Date(y, m, d-3, 16, 0),
      			allDay: false
      		}]
      		,
      		editable: true,
      		droppable: true, // this allows things to be dropped onto the calendar !!!
      		drop: function(date, allDay) { // this function is called when something is dropped
      		
      			// retrieve the dropped element's stored Event Object
      			var originalEventObject = $(this).data('eventObject');
      			var $extraEventClass = $(this).attr('data-class');
      			
      			
      			// we need to copy it, so that multiple events don't have a reference to the same object
      			var copiedEventObject = $.extend({}, originalEventObject);
      			
      			// assign it the date that was reported
      			copiedEventObject.start = date;
      			copiedEventObject.allDay = allDay;
      			if($extraEventClass) copiedEventObject['className'] = [$extraEventClass];
      			
      			// render the event on the calendar
      			// the last `true` argument determines if the event "sticks" (http://arshaw.com/fullcalendar/docs/event_rendering/renderEvent/)
      			$('#calendar').fullCalendar('renderEvent', copiedEventObject, true);
      			
      			// is the "remove after drop" checkbox checked?
      			if ($('#drop-remove').is(':checked')) {
      				// if so, remove the element from the "Draggable Events" list
      				$(this).remove();
      			}
      			
      		}
      		,
      		selectable: true,
      		selectHelper: true,
      		select: function(start, end, allDay) {
      			
      			bootbox.prompt("New Event Title:", function(title) {
      				if (title !== null) {
      					calendar.fullCalendar('renderEvent',
      						{
      							title: title,
      							start: start,
      							end: end,
      							allDay: allDay
      						},
      						true // make the event "stick"
      					);
      				}
      			});
      			
      
      			calendar.fullCalendar('unselect');
      			
      		}
      		,
      		eventClick: function(calEvent, jsEvent, view) {
      
      			var form = $("<form class='form-inline'><label>Change event name &nbsp;</label></form>");
      			form.append("<input autocomplete=off type=text value='" + calEvent.title + "' /> ");
      			form.append("<button type='submit' class='btn btn-small btn-success'><i class='icon-ok'></i> Save</button>");
      			
      			var div = bootbox.dialog(form,
      				[
      				{
      					"label" : "<i class='icon-trash'></i> Delete Event",
      					"class" : "btn-small btn-danger",
      					"callback": function() {
      						calendar.fullCalendar('removeEvents' , function(ev){
      							return (ev._id == calEvent._id);
      						})
      					}
      				}
      				,
      				{
      					"label" : "<i class='icon-remove'></i> Close",
      					"class" : "btn-small"
      				}
      				]
      				,
      				{
      					// prompts need a few extra options
      					"onEscape": function(){div.modal("hide");}
      				}
      			);
      			
      			form.on('submit', function(){
      				calEvent.title = form.find("input[type=text]").val();
      				calendar.fullCalendar('updateEvent', calEvent);
      				div.modal("hide");
      				return false;
      			});
      			
      		
      			//console.log(calEvent.id);
      			//console.log(jsEvent);
      			//console.log(view);
      
      			// change the border color just for fun
      			//$(this).css('border-color', 'red');
      
      		}
      		
      	});
      
      
      })
